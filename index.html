<!DOCTYPE html>
<html lang="en" data-theme="light">
<head>
<meta charset="UTF-8">
<meta name="viewport" content="width=device-width, initial-scale=1.0">
<title>The AI Displacement — America's Tech Workforce</title>
<link rel="preconnect" href="https://fonts.googleapis.com">
<link rel="preconnect" href="https://fonts.gstatic.com" crossorigin>
<script src="https://cdn.jsdelivr.net/npm/gsap@3.12.5/dist/gsap.min.js"></script>
<script src="https://cdn.jsdelivr.net/npm/gsap@3.12.5/dist/ScrollTrigger.min.js"></script>
<link href="https://fonts.googleapis.com/css2?family=Inter:ital,wght@0,300;0,400;0,500;0,600;0,700;0,800;0,900;1,300;1,400&display=swap" rel="stylesheet">
<style>
/* ── Reset ── */
*, *::before, *::after { margin: 0; padding: 0; box-sizing: border-box; }

/* ── Design Tokens ── */
:root {
  --bg:        #f5f5f7;
  --surface:   #ffffff;
  --surface2:  #f0f0f5;
  --text:      #1d1d1f;
  --text2:     #6e6e73;
  --border:    rgba(0,0,0,0.08);
  --accent:    #0071e3;
  --red:       #ff3b30;
  --orange:    #ff9500;
  --green:     #34c759;
  --font:      'Inter', -apple-system, 'SF Pro Display', sans-serif;
  --transition: 0.4s cubic-bezier(0.4, 0, 0.2, 1);
  --radius:    18px;
  --radius-sm: 10px;
}
[data-theme="dark"] {
  --bg:        #000000;
  --surface:   #1c1c1e;
  --surface2:  #2c2c2e;
  --text:      #f5f5f7;
  --text2:     #98989d;
  --border:    rgba(255,255,255,0.1);
  --accent:    #2997ff;
}

/* ── Base ── */
html, body { overflow-x: hidden; }
html { scroll-behavior: smooth; -webkit-overflow-scrolling: touch; }
body {
  font-family: var(--font);
  background: var(--bg);
  color: var(--text);
  -webkit-font-smoothing: antialiased;
  line-height: 1.5;
  overflow-x: hidden;
}
/* Theme transition only when explicitly toggling (avoids repaints on scroll) */
html.theme-transitioning body,
html.theme-transitioning .card,
html.theme-transitioning .card-sm,
html.theme-transitioning section,
html.theme-transitioning footer,
html.theme-transitioning #theme-toggle,
html.theme-transitioning .quote-card,
html.theme-transitioning .slider-section,
html.theme-transitioning .big-stat-hero,
html.theme-transitioning .retraining-gap,
html.theme-transitioning .city-card,
html.theme-transitioning .prec-item {
  transition: background 0.35s ease, color 0.35s ease, border-color 0.35s ease;
}

/* ── Theme Toggle ── */
#theme-toggle {
  position: fixed;
  top: 20px;
  right: 24px;
  z-index: 1000;
  background: var(--surface);
  border: 1px solid var(--border);
  border-radius: 50px;
  width: 48px;
  height: 48px;
  cursor: pointer;
  display: flex;
  align-items: center;
  justify-content: center;
  font-size: 20px;
  transition: all 0.3s ease;
  box-shadow: 0 2px 12px rgba(0,0,0,0.12);
}
#theme-toggle:hover { transform: scale(1.1); }

/* ── Progress Bar ── */
#progress {
  position: fixed;
  top: 0; left: 0;
  height: 3px;
  background: var(--accent);
  z-index: 999;
  width: 100%;
  transform: scaleX(0);
  transform-origin: left center;
  will-change: transform;
}

/* ── Section Nav Dots ── */
#section-nav {
  position: fixed;
  right: 24px;
  top: 50%;
  transform: translateY(-50%);
  z-index: 900;
  display: flex;
  flex-direction: column;
  gap: 10px;
}
.nav-dot {
  width: 8px;
  height: 8px;
  border-radius: 50%;
  background: var(--text2);
  cursor: pointer;
  transition: all 0.3s ease;
  opacity: 0.4;
}
.nav-dot.active {
  opacity: 1;
  background: var(--accent);
  transform: scale(1.4);
}

/* ── Container ── */
.container {
  max-width: 1200px;
  margin: 0 auto;
  padding: 0 40px;
}

/* ── Sections ── */
section {
  padding: 120px 0;
  position: relative;
}
section:nth-child(odd) { background: var(--bg); }
section:nth-child(even) { background: var(--surface2); }

/* ── Hero ── */
#hero {
  min-height: 100vh;
  display: flex;
  align-items: center;
  background: var(--bg);
  padding: 80px 0;
}
.hero-label {
  font-size: 13px;
  font-weight: 600;
  letter-spacing: 0.12em;
  text-transform: uppercase;
  color: var(--accent);
  margin-bottom: 24px;
}
.hero-title {
  font-size: clamp(48px, 7vw, 96px);
  font-weight: 800;
  line-height: 1.02;
  letter-spacing: -0.03em;
  color: var(--text);
  margin-bottom: 32px;
}
.hero-subtitle {
  font-size: clamp(18px, 2.5vw, 24px);
  color: var(--text2);
  font-weight: 400;
  max-width: 600px;
  line-height: 1.6;
  margin-bottom: 60px;
}
.hero-stats {
  display: grid;
  grid-template-columns: repeat(auto-fit, minmax(200px, 1fr));
  gap: 24px;
  margin-top: 60px;
}
.hero-stat {
  background: var(--surface);
  border: 1px solid var(--border);
  border-radius: var(--radius);
  padding: 28px;
}
.hero-stat-num {
  font-size: clamp(32px, 4vw, 48px);
  font-weight: 800;
  letter-spacing: -0.03em;
  color: var(--text);
  line-height: 1;
  margin-bottom: 8px;
}
.hero-stat-label {
  font-size: 14px;
  color: var(--text2);
  font-weight: 500;
}
.hero-big-stat {
  background: var(--surface);
  border: 1px solid var(--border);
  border-radius: var(--radius);
  padding: 40px;
  text-align: center;
  margin-bottom: 24px;
}
.hero-big-stat-num {
  font-size: clamp(40px, 6vw, 72px);
  font-weight: 900;
  letter-spacing: -0.04em;
  color: var(--text);
  line-height: 1;
}
.hero-big-stat-sub {
  font-size: 16px;
  color: var(--text2);
  margin-top: 12px;
}

/* ── Section Headers ── */
.section-label {
  font-size: 13px;
  font-weight: 600;
  letter-spacing: 0.12em;
  text-transform: uppercase;
  color: var(--accent);
  margin-bottom: 20px;
}
.section-title {
  font-size: clamp(36px, 5vw, 64px);
  font-weight: 800;
  letter-spacing: -0.03em;
  line-height: 1.05;
  color: var(--text);
  margin-bottom: 24px;
}
.section-desc {
  font-size: 18px;
  color: var(--text2);
  max-width: 700px;
  line-height: 1.7;
  margin-bottom: 64px;
}

/* ── Cards ── */
.card {
  background: var(--surface);
  border: 1px solid var(--border);
  border-radius: var(--radius);
  padding: 36px;
}
.card-sm {
  background: var(--surface);
  border: 1px solid var(--border);
  border-radius: var(--radius-sm);
  padding: 24px;
}

/* ── Grid Layouts ── */
.grid-2 { display: grid; grid-template-columns: 1fr 1fr; gap: 24px; }
.grid-3 { display: grid; grid-template-columns: repeat(3, 1fr); gap: 24px; }
.grid-auto { display: grid; grid-template-columns: repeat(auto-fit, minmax(280px, 1fr)); gap: 24px; }

/* ── Charts ── */
.chart-title {
  font-size: 14px;
  font-weight: 700;
  text-transform: uppercase;
  letter-spacing: 0.06em;
  color: var(--text2);
  margin-bottom: 20px;
}

/* Metro Bar Chart */
.metro-bar {
  display: flex;
  align-items: center;
  gap: 16px;
  margin-bottom: 14px;
}
.metro-name {
  font-size: 14px;
  font-weight: 600;
  color: var(--text);
  min-width: 110px;
  text-align: right;
}
.metro-track {
  flex: 1;
  height: 36px;
  background: var(--surface2);
  border-radius: 6px;
  overflow: hidden;
  position: relative;
}
.metro-fill {
  height: 100%;
  background: linear-gradient(90deg, var(--accent), #5ac8fa);
  border-radius: 6px;
  width: 100%;
  transform: scaleX(0);
  transform-origin: left center;
  display: flex;
  align-items: center;
  justify-content: flex-end;
  padding-right: 12px;
}
.metro-fill span {
  font-size: 13px;
  font-weight: 700;
  color: white;
  white-space: nowrap;
}

/* Salary Gradient */
.salary-track {
  position: relative;
  height: 24px;
  border-radius: 12px;
  background: linear-gradient(90deg, #34c759 0%, #0071e3 40%, #5856d6 75%, #ff2d55 100%);
  margin: 40px 0 50px;
}
.salary-markers {
  position: relative;
  display: flex;
  justify-content: space-between;
}
.salary-marker {
  text-align: center;
  flex: 1;
}
.salary-marker-val {
  font-size: 15px;
  font-weight: 800;
  color: var(--text);
}
.salary-marker-lbl {
  font-size: 11px;
  color: var(--text2);
  margin-top: 4px;
}
.salary-tick {
  position: absolute;
  top: -38px;
  width: 2px;
  height: 20px;
  background: rgba(0,0,0,0.2);
  left: 50%;
  transform: translateX(-50%);
}
[data-theme="dark"] .salary-tick { background: rgba(255,255,255,0.2); }

/* Age Distribution */
.age-bars {
  display: flex;
  align-items: flex-end;
  gap: 8px;
  height: 120px;
}
.age-bar-wrap {
  flex: 1;
  display: flex;
  flex-direction: column;
  align-items: center;
  height: 100%;
}
.age-bar {
  width: 100%;
  border-radius: 6px 6px 0 0;
  margin-top: auto;
  opacity: 0.9;
  transform: scaleY(0);
  transform-origin: bottom center;
  /* height set via inline style from data-height attribute */
}

.age-label {
  font-size: 11px;
  color: var(--text2);
  margin-top: 8px;
  text-align: center;
}
.age-val {
  font-size: 14px;
  font-weight: 700;
  color: var(--text);
  margin-bottom: 6px;
}

/* ── Section 2: Slider ── */
.quote-card {
  background: var(--surface);
  border: 1px solid var(--border);
  border-left: 4px solid var(--accent);
  border-radius: var(--radius-sm);
  padding: 28px 32px;
  margin-bottom: 48px;
}
.quote-text {
  font-size: 18px;
  font-weight: 400;
  color: var(--text);
  line-height: 1.7;
  font-style: italic;
  margin-bottom: 12px;
}
.quote-attr {
  font-size: 13px;
  color: var(--text2);
  font-weight: 600;
}

.slider-section {
  background: var(--surface);
  border: 1px solid var(--border);
  border-radius: var(--radius);
  padding: 48px;
  margin-bottom: 32px;
}
.slider-label {
  font-size: 13px;
  font-weight: 600;
  letter-spacing: 0.08em;
  text-transform: uppercase;
  color: var(--text2);
  margin-bottom: 16px;
}
.slider-display {
  font-size: clamp(48px, 7vw, 80px);
  font-weight: 900;
  letter-spacing: -0.04em;
  color: var(--red);
  line-height: 1;
  margin-bottom: 8px;
}
.slider-sub {
  font-size: 16px;
  color: var(--text2);
  margin-bottom: 32px;
}
#cut-slider {
  -webkit-appearance: none;
  width: 100%;
  height: 8px;
  border-radius: 4px;
  background: var(--surface2);
  outline: none;
  margin-bottom: 12px;
  cursor: pointer;
  position: relative;
}
#cut-slider::-webkit-slider-thumb {
  -webkit-appearance: none;
  width: 28px;
  height: 28px;
  border-radius: 50%;
  background: var(--accent);
  cursor: pointer;
  box-shadow: 0 2px 8px rgba(0,113,227,0.4);
  transition: transform 0.15s;
}
#cut-slider::-webkit-slider-thumb:hover { transform: scale(1.15); }
.slider-range {
  display: flex;
  justify-content: space-between;
  font-size: 12px;
  color: var(--text2);
}

/* Job Grid */
.job-grid {
  display: grid;
  grid-template-columns: repeat(10, 1fr);
  gap: 6px;
  margin-top: 24px;
}
.job-dot {
  width: 100%;
  padding-bottom: 100%;
  border-radius: 50%;
  background: var(--accent);
  transition: background 0.4s ease;
}
.job-dot.displaced {
  background: var(--red);
}

/* Company bars */
.company-row {
  display: flex;
  align-items: center;
  gap: 16px;
  margin-bottom: 16px;
}
.company-name {
  font-size: 14px;
  font-weight: 700;
  color: var(--text);
  min-width: 120px;
}
.company-track {
  flex: 1;
  height: 32px;
  background: var(--surface2);
  border-radius: 6px;
  overflow: hidden;
  position: relative;
}
.company-fill {
  height: 100%;
  background: linear-gradient(90deg, var(--red), #ff6b6b);
  border-radius: 6px;
  width: 100%;
  transform: scaleX(0);
  transform-origin: left center;
  display: flex;
  align-items: center;
  justify-content: flex-end;
  padding-right: 10px;
}
.company-fill span {
  font-size: 12px;
  font-weight: 700;
  color: white;
  white-space: nowrap;
}

/* Historical comparison */
.hist-bars {
  display: flex;
  align-items: flex-end;
  gap: 24px;
  height: 200px;
  padding-top: 20px;
}
.hist-bar-wrap {
  flex: 1;
  display: flex;
  flex-direction: column;
  align-items: center;
  height: 100%;
}
.hist-bar {
  width: 100%;
  border-radius: 8px 8px 0 0;
  margin-top: auto;
  transition: height 1.2s cubic-bezier(0.4,0,0.2,1);
}
.hist-bar-label {
  font-size: 12px;
  color: var(--text2);
  margin-top: 10px;
  text-align: center;
  font-weight: 500;
}
.hist-bar-val {
  font-size: 14px;
  font-weight: 800;
  color: var(--text);
  margin-bottom: 8px;
}

/* ── Section 3: Economic ── */
.big-stat-hero {
  text-align: center;
  padding: 60px 40px;
  background: var(--surface);
  border: 1px solid var(--border);
  border-radius: var(--radius);
  margin-bottom: 32px;
}
.big-stat-num {
  font-size: clamp(60px, 10vw, 120px);
  font-weight: 900;
  letter-spacing: -0.04em;
  line-height: 1;
  color: var(--text);
}
.big-stat-desc {
  font-size: 18px;
  color: var(--text2);
  margin-top: 16px;
  max-width: 500px;
  margin-left: auto;
  margin-right: auto;
}

/* Donut chart */
#donut-svg { display: block; margin: 0 auto; }
.donut-legend {
  display: flex;
  flex-wrap: wrap;
  gap: 16px;
  justify-content: center;
  margin-top: 24px;
}
.legend-item {
  display: flex;
  align-items: center;
  gap: 8px;
  font-size: 13px;
  color: var(--text2);
}
.legend-dot {
  width: 12px;
  height: 12px;
  border-radius: 3px;
  flex-shrink: 0;
}

/* City heat grid */
.city-grid {
  display: grid;
  grid-template-columns: repeat(auto-fit, minmax(160px, 1fr));
  gap: 16px;
}
.city-card {
  border-radius: var(--radius-sm);
  padding: 20px;
  text-align: center;
  border: 1px solid var(--border);
}
.city-name {
  font-size: 15px;
  font-weight: 700;
  color: var(--text);
  margin-bottom: 8px;
}
.city-drop {
  font-size: 28px;
  font-weight: 900;
  letter-spacing: -0.02em;
}
.city-label {
  font-size: 12px;
  color: var(--text2);
  margin-top: 4px;
}

/* Multiplier timeline */
.timeline {
  position: relative;
  padding-left: 32px;
}
.timeline::before {
  content: '';
  position: absolute;
  left: 8px;
  top: 0; bottom: 0;
  width: 2px;
  background: var(--border);
}
.timeline-item {
  position: relative;
  margin-bottom: 32px;
}
.timeline-dot {
  position: absolute;
  left: -28px;
  top: 4px;
  width: 14px;
  height: 14px;
  border-radius: 50%;
  background: var(--accent);
}
.timeline-time {
  font-size: 12px;
  font-weight: 700;
  letter-spacing: 0.08em;
  text-transform: uppercase;
  color: var(--accent);
  margin-bottom: 6px;
}
.timeline-title {
  font-size: 16px;
  font-weight: 700;
  color: var(--text);
  margin-bottom: 6px;
}
.timeline-desc {
  font-size: 14px;
  color: var(--text2);
  line-height: 1.6;
}

/* ── Section 4: Where do they go ── */
/* Sankey */
#sankey-canvas {
  width: 100%;
  height: 320px;
  display: block;
}

.destination-bars {
  display: flex;
  flex-direction: column;
  gap: 12px;
}
.dest-row {
  display: flex;
  align-items: center;
  gap: 16px;
}
.dest-label {
  font-size: 13px;
  font-weight: 600;
  color: var(--text);
  min-width: 220px;
}
.dest-track {
  flex: 1;
  height: 28px;
  background: var(--surface2);
  border-radius: 6px;
  overflow: hidden;
}
.dest-fill {
  height: 100%;
  border-radius: 6px;
  display: flex;
  align-items: center;
  padding-left: 10px;
  width: 100%;
  transform: scaleX(0);
  transform-origin: left center;
}

.dest-fill span {
  font-size: 12px;
  font-weight: 700;
  color: white;
  white-space: nowrap;
}
.dest-pct {
  font-size: 14px;
  font-weight: 800;
  color: var(--text);
  min-width: 40px;
  text-align: right;
}

/* Retraining gap */
.retraining-gap {
  text-align: center;
  padding: 60px;
  background: var(--surface);
  border: 1px solid var(--border);
  border-radius: var(--radius);
}
.gap-number {
  font-size: clamp(80px, 14vw, 160px);
  font-weight: 900;
  letter-spacing: -0.04em;
  color: var(--red);
  line-height: 1;
}
.gap-label {
  font-size: 18px;
  color: var(--text2);
  margin-top: 12px;
}

/* Replacement bar */
.replacement-bars {
  display: flex;
  flex-direction: column;
  gap: 20px;
}
.repl-row {
  display: flex;
  flex-direction: column;
  gap: 8px;
}
.repl-label {
  font-size: 14px;
  font-weight: 600;
  color: var(--text);
  display: flex;
  justify-content: space-between;
}
.repl-track {
  height: 40px;
  background: var(--surface2);
  border-radius: 8px;
  overflow: hidden;
}
.repl-fill {
  height: 100%;
  border-radius: 8px;
  display: flex;
  align-items: center;
  padding-left: 14px;
  width: 100%;
  transform: scaleX(0);
  transform-origin: left center;
}

.repl-fill span {
  font-size: 14px;
  font-weight: 700;
  color: white;
}

/* Precedent timeline */
.prec-items {
  display: flex;
  flex-direction: column;
  gap: 0;
}
.prec-item {
  display: grid;
  grid-template-columns: 120px 1fr;
  gap: 24px;
  padding: 24px 0;
  border-bottom: 1px solid var(--border);
}
.prec-item:last-child { border-bottom: none; }
.prec-year {
  font-size: 28px;
  font-weight: 900;
  letter-spacing: -0.02em;
  color: var(--text);
}
.prec-era {
  font-size: 12px;
  color: var(--text2);
  font-weight: 500;
  margin-top: 4px;
}
.prec-title {
  font-size: 16px;
  font-weight: 700;
  color: var(--text);
  margin-bottom: 8px;
}
.prec-desc {
  font-size: 14px;
  color: var(--text2);
  line-height: 1.6;
}
.prec-outcome {
  display: inline-block;
  font-size: 12px;
  font-weight: 700;
  padding: 4px 10px;
  border-radius: 20px;
  margin-top: 10px;
}

/* ── Footer ── */
footer {
  background: var(--surface);
  border-top: 1px solid var(--border);
  padding: 80px 0 60px;
}
.footer-quote {
  font-size: clamp(16px, 2vw, 20px);
  font-style: italic;
  color: var(--text2);
  max-width: 800px;
  line-height: 1.7;
  margin-bottom: 48px;
  padding-bottom: 48px;
  border-bottom: 1px solid var(--border);
}
.sources-title {
  font-size: 11px;
  font-weight: 700;
  text-transform: uppercase;
  letter-spacing: 0.1em;
  color: var(--text2);
  margin-bottom: 16px;
}
.sources-list {
  display: flex;
  flex-wrap: wrap;
  gap: 8px 24px;
}
.source-item {
  font-size: 12px;
  color: var(--text2);
  opacity: 0.7;
}
.source-item::before {
  content: '↗';
  margin-right: 4px;
  font-size: 10px;
}

/* Reveal initial state set by GSAP (gsap.set) — no CSS transition needed */
.reveal { opacity: 1; } /* fallback if GSAP not loaded */

/* No forced GPU promotion — too many layers hurts more than it helps */

/* ── Loading Screen ── */
#loader {
  position: fixed;
  inset: 0;
  z-index: 9999;
  background: var(--bg);
  display: flex;
  flex-direction: column;
  align-items: center;
  justify-content: center;
  gap: 20px;
  transition: opacity 0.5s ease;
}
#loader.fade-out {
  opacity: 0;
  pointer-events: none;
}
.loader-logo {
  font-size: 15px;
  font-weight: 700;
  letter-spacing: 0.18em;
  text-transform: uppercase;
  color: var(--text2);
}
.loader-bar-track {
  width: 200px;
  height: 3px;
  background: var(--border);
  border-radius: 3px;
  overflow: hidden;
}
.loader-bar-fill {
  height: 100%;
  width: 0%;
  background: var(--accent);
  border-radius: 3px;
  transition: width 0.15s ease;
}
.reveal-delay-1, .reveal-delay-2, .reveal-delay-3, .reveal-delay-4 {}

/* ── Responsive ── */
@media (max-width: 768px) {
  .container { padding: 0 20px; }
  section { padding: 80px 0; }
  .grid-2, .grid-3 { grid-template-columns: 1fr; }
  .slider-section { padding: 28px; }
  .big-stat-hero { padding: 40px 24px; }
  .retraining-gap { padding: 40px 24px; }
  .dest-label { min-width: 140px; font-size: 12px; }
  .prec-item { grid-template-columns: 1fr; gap: 8px; }
  .hist-bars { height: 160px; gap: 12px; }
  #section-nav { display: none; }
  .metro-name { min-width: 80px; font-size: 12px; }
}

@media (max-width: 480px) {
  .hero-stats { grid-template-columns: 1fr 1fr; }
  .job-grid { gap: 4px; }
}

/* ── Utility ── */
.mt-8 { margin-top: 8px; }
.mt-16 { margin-top: 16px; }
.mt-24 { margin-top: 24px; }
.mt-32 { margin-top: 32px; }
.mt-48 { margin-top: 48px; }
.mb-32 { margin-bottom: 32px; }
.text-accent { color: var(--accent); }
.text-red { color: var(--red); }
.text-center { text-align: center; }
.fw-900 { font-weight: 900; }

/* New roles comparison */
.roles-comparison {
  display: flex;
  gap: 24px;
  align-items: stretch;
  margin-bottom: 32px;
}
.role-bar-wrap {
  flex: 1;
  display: flex;
  flex-direction: column;
}
.role-bar-label {
  font-size: 13px;
  font-weight: 600;
  color: var(--text2);
  margin-bottom: 12px;
  text-align: center;
}
.role-bar-num {
  font-size: 22px;
  font-weight: 900;
  text-align: center;
  letter-spacing: -0.02em;
  margin-bottom: 12px;
}
.role-bar {
  flex: 1;
  border-radius: 8px;
  min-height: 20px;
  transition: height 1.2s cubic-bezier(0.4,0,0.2,1);
}
@media (max-width: 600px) {
  .roles-comparison { flex-direction: column; }
}

/* ── Sources FAB ── */
#sources-fab {
  position: fixed;
  bottom: 28px;
  right: 28px;
  z-index: 900;
  width: 52px;
  height: 52px;
  border-radius: 50%;
  background: var(--accent);
  color: #fff;
  border: none;
  font-size: 20px;
  cursor: pointer;
  display: flex;
  align-items: center;
  justify-content: center;
  box-shadow: 0 4px 20px rgba(0,113,227,0.45);
  transition: transform 0.2s ease, box-shadow 0.2s ease;
  line-height: 1;
}
#sources-fab:hover {
  transform: scale(1.08);
  box-shadow: 0 8px 28px rgba(0,113,227,0.55);
}

/* ── Sources Modal ── */
#source-modal-overlay {
  display: none;
  position: fixed;
  inset: 0;
  background: rgba(0,0,0,0.3);
  z-index: 10000;
  align-items: flex-end;
  justify-content: flex-end;
  padding: 24px;
  backdrop-filter: blur(6px);
}
#source-modal-overlay.open { display: flex; }
#source-modal {
  background: var(--surface);
  border-radius: var(--radius);
  border: 1px solid var(--border);
  padding: 32px;
  width: 100%;
  max-width: 520px;
  max-height: 80vh;
  overflow-y: auto;
  position: relative;
  box-shadow: 0 32px 80px rgba(0,0,0,0.25), 0 0 0 1px rgba(255,255,255,0.06);
}
#source-modal-close {
  position: sticky;
  top: 0;
  float: right;
  width: 30px; height: 30px;
  border-radius: 50%;
  border: none;
  background: var(--surface2);
  color: var(--text2);
  font-size: 16px;
  cursor: pointer;
  display: flex; align-items: center; justify-content: center;
  margin-left: 12px;
  flex-shrink: 0;
  z-index: 1;
}
#source-modal-title {
  font-size: 18px;
  font-weight: 800;
  letter-spacing: -0.02em;
  color: var(--text);
  margin-bottom: 6px;
  padding-right: 40px;
}
#source-modal-subtitle {
  font-size: 13px;
  color: var(--text2);
  margin-bottom: 28px;
}
.source-group {
  margin-bottom: 28px;
}
.source-group:last-child { margin-bottom: 0; }
.source-group-title {
  font-size: 11px;
  font-weight: 700;
  text-transform: uppercase;
  letter-spacing: 0.1em;
  color: var(--accent);
  margin-bottom: 12px;
  padding-bottom: 8px;
  border-bottom: 1px solid var(--border);
}
.source-item {
  padding: 10px 0;
  border-bottom: 1px solid var(--border);
}
.source-item:last-child { border-bottom: none; }
.source-item-name { font-size: 13px; font-weight: 600; color: var(--text); margin-bottom: 3px; }
.source-item-url a { font-size: 12px; color: var(--accent); text-decoration: none; word-break: break-all; }
.source-item-url a:hover { text-decoration: underline; }
</style>
</head>
<body>

<!-- Loading screen -->
<div id="loader">
  <div class="loader-logo">AI Displacement Report</div>
  <div class="loader-bar-track"><div class="loader-bar-fill" id="loader-fill"></div></div>
</div>


<!-- Sources FAB -->
<button id="sources-fab" aria-label="View all sources">ⓘ</button>

<!-- Sources Modal -->
<div id="source-modal-overlay" role="dialog" aria-modal="true" aria-labelledby="source-modal-title">
  <div id="source-modal">
    <button id="source-modal-close" aria-label="Close">✕</button>
    <div id="source-modal-title">Sources & References</div>
    <div id="source-modal-subtitle">All data used in this report, organized by section.</div>
    <div id="source-modal-body"></div>
  </div>
</div>

<!-- Progress bar -->
<div id="progress"></div>

<!-- Theme toggle -->
<button id="theme-toggle" aria-label="Toggle dark mode">☀️</button>

<!-- Section nav dots -->
<nav id="section-nav" aria-label="Section navigation">
  <div class="nav-dot active" data-section="0" title="The Industry Today"></div>
  <div class="nav-dot" data-section="1" title="The Block Effect"></div>
  <div class="nav-dot" data-section="2" title="Economic Aftershock"></div>
  <div class="nav-dot" data-section="3" title="Where Do They Go"></div>
</nav>

<!-- ═══════════════════════════════════════════════
     SECTION 1: THE INDUSTRY TODAY
═══════════════════════════════════════════════ -->
<section id="s1" data-section="0">
  <div class="container">

    <div class="reveal">
      <div class="section-label">Section 01 — The Industry Today</div>
      <h1 class="section-title">America's $1.6 Trillion<br>Tech Workforce</h1>
      <p class="section-desc">The US software industry is the most valuable white-collar sector in American history — 6.5 million workers, $845 billion in annual wages, and a talent pipeline of 100,000 new graduates each year.</p>
    </div>

    <!-- Hero stats -->
    <div class="grid-2 reveal reveal-delay-1" style="margin-bottom:24px;">
      <div class="big-stat-hero">
        <div class="big-stat-num" data-countup="6500000" data-prefix="" data-suffix="M" data-divisor="1000000" data-decimals="1">6.5M</div>
        <div class="big-stat-desc">Total IT & Computer Workers in the US</div>
      </div>
      <div class="big-stat-hero">
        <div class="big-stat-num" data-countup="845" data-prefix="$" data-suffix="B">$845B</div>
        <div class="big-stat-desc">In Annual Wages Across the Sector</div>
      </div>
    </div>

    <div class="grid-3 reveal reveal-delay-2" style="margin-bottom:48px;">
      <div class="card-sm">
        <div class="hero-stat-num" data-countup="4400000" data-prefix="" data-suffix="M" data-divisor="1000000" data-decimals="1">4.4M</div>
        <div class="hero-stat-label">Software Developers & Engineers</div>
      </div>
      <div class="card-sm">
        <div class="hero-stat-num" data-countup="130000" data-prefix="$" data-suffix="K" data-divisor="1000">$130K</div>
        <div class="hero-stat-label">Median SWE Salary (BLS 2024)</div>
      </div>
      <div class="card-sm">
        <div class="hero-stat-num" data-countup="100000" data-prefix="" data-suffix="K" data-divisor="1000">100K</div>
        <div class="hero-stat-label">CS/CE Grads Entering Each Year</div>
      </div>
    </div>

    <!-- Metro Chart + Salary -->
    <div class="grid-2 reveal reveal-delay-2" style="margin-bottom:32px;">
      <div class="card">
        <div class="chart-title">Top Tech Metro Areas</div>
        <div id="metro-chart">
          <div class="metro-bar">
            <div class="metro-name">SF Bay Area</div>
            <div class="metro-track"><div class="metro-fill" data-width="100"><span>350K</span></div></div>
          </div>
          <div class="metro-bar">
            <div class="metro-name">Seattle</div>
            <div class="metro-track"><div class="metro-fill" data-width="63"><span>220K</span></div></div>
          </div>
          <div class="metro-bar">
            <div class="metro-name">New York</div>
            <div class="metro-track"><div class="metro-fill" data-width="51"><span>180K</span></div></div>
          </div>
          <div class="metro-bar">
            <div class="metro-name">Austin</div>
            <div class="metro-track"><div class="metro-fill" data-width="34"><span>120K</span></div></div>
          </div>
          <div class="metro-bar">
            <div class="metro-name">Boston</div>
            <div class="metro-track"><div class="metro-fill" data-width="29"><span>100K</span></div></div>
          </div>
        </div>
      </div>

      <div class="card">
        <div class="chart-title">Age Distribution of Tech Workers</div>
        <div class="age-bars" id="age-chart">
          <div class="age-bar-wrap">
            <div class="age-val">42%</div>
            <div class="age-bar" data-height="85" style="height:85px; background: var(--accent);"></div>
            <div class="age-label">25–34</div>
          </div>
          <div class="age-bar-wrap">
            <div class="age-val">31%</div>
            <div class="age-bar" data-height="63" style="height:63px; background: #5ac8fa;"></div>
            <div class="age-label">35–44</div>
          </div>
          <div class="age-bar-wrap">
            <div class="age-val">18%</div>
            <div class="age-bar" data-height="37" style="height:37px; background: #5856d6;"></div>
            <div class="age-label">45–54</div>
          </div>
          <div class="age-bar-wrap">
            <div class="age-val">9%</div>
            <div class="age-bar" data-height="18" style="height:18px; background: #af52de;"></div>
            <div class="age-label">55+</div>
          </div>
        </div>
        <div class="mt-24" style="font-size:13px; color:var(--text2);">The tech workforce skews young — 73% under 45.</div>
      </div>
    </div>

    <!-- Salary bar -->
    <div class="card reveal reveal-delay-3">
      <div class="chart-title">Salary Distribution — US Software Engineers</div>
      <!-- Pinned marker chart: gradient bar with diamond pins + drop lines -->
      <div style="position:relative; padding: 0 0 72px; margin-top:8px;">
        <!-- Gradient bar -->
        <div style="height:20px; border-radius:10px; background:linear-gradient(90deg,#34c759 0%,#0071e3 37%,#5856d6 72%,#ff2d55 100%); position:relative; z-index:1;"></div>
        <!-- Pins: positioned at % along bar -->
        <!-- $85K = 0%, $130K = 37%, $212K = 72%, $350K = 100% -->
        <div style="position:relative; height:72px;">
          <!-- Pin 1: $85K at 0% -->
          <div style="position:absolute; left:0%; transform:translateX(-50%);">
            <div style="width:2px; height:20px; background:#34c759; margin:0 auto;"></div>
            <div style="width:10px; height:10px; background:#34c759; border-radius:50%; margin:-5px auto 4px; transform:translateY(-4px);"></div>
            <div style="text-align:center; margin-top:4px;">
              <div style="font-size:16px; font-weight:900; color:var(--text); letter-spacing:-0.02em;">$85K</div>
              <div style="font-size:11px; color:var(--text2); margin-top:2px;">25th pct.</div>
            </div>
          </div>
          <!-- Pin 2: $130K at 37% -->
          <div style="position:absolute; left:37%; transform:translateX(-50%);">
            <div style="width:2px; height:20px; background:#0071e3; margin:0 auto;"></div>
            <div style="width:10px; height:10px; background:#0071e3; border-radius:50%; margin:-5px auto 4px; transform:translateY(-4px);"></div>
            <div style="text-align:center; margin-top:4px;">
              <div style="font-size:16px; font-weight:900; color:var(--text); letter-spacing:-0.02em;">$130K</div>
              <div style="font-size:11px; color:var(--text2); margin-top:2px;">Median</div>
            </div>
          </div>
          <!-- Pin 3: $212K at 72% -->
          <div style="position:absolute; left:72%; transform:translateX(-50%);">
            <div style="width:2px; height:20px; background:#5856d6; margin:0 auto;"></div>
            <div style="width:10px; height:10px; background:#5856d6; border-radius:50%; margin:-5px auto 4px; transform:translateY(-4px);"></div>
            <div style="text-align:center; margin-top:4px;">
              <div style="font-size:16px; font-weight:900; color:var(--text); letter-spacing:-0.02em;">$212K</div>
              <div style="font-size:11px; color:var(--text2); margin-top:2px;">FAANG avg</div>
            </div>
          </div>
          <!-- Pin 4: $350K+ at 100% -->
          <div style="position:absolute; left:100%; transform:translateX(-50%);">
            <div style="width:2px; height:20px; background:#ff2d55; margin:0 auto;"></div>
            <div style="width:10px; height:10px; background:#ff2d55; border-radius:50%; margin:-5px auto 4px; transform:translateY(-4px);"></div>
            <div style="text-align:center; margin-top:4px;">
              <div style="font-size:16px; font-weight:900; color:var(--text); letter-spacing:-0.02em;">$350K+</div>
              <div style="font-size:11px; color:var(--text2); margin-top:2px;">Top 10%</div>
            </div>
          </div>
        </div>
      </div>
      <div style="display:flex; justify-content:space-between; align-items:center; flex-wrap:wrap; gap:12px; margin-top:8px;">
        <div style="font-size:13px; color:var(--text2);">+25% industry growth from 2018–2023. The sector expanded nearly every year for a decade.</div>
        <div style="background: var(--surface2); border-radius: 8px; padding: 8px 16px; font-size: 13px; font-weight: 700; color: var(--green);">+25% ↑ 2018–2023</div>
      </div>
    </div>

  </div>
</section>


<!-- ═══════════════════════════════════════════════
     SECTION 2: THE BLOCK EFFECT
═══════════════════════════════════════════════ -->
<section id="s2" data-section="1">
  <div class="container">

    <div class="reveal">
      <div class="section-label">Section 02 — The Block Effect</div>
      <h2 class="section-title">40% Cuts.<br>Industry-Wide.</h2>
      <p class="section-desc">Block's CEO Jack Dorsey announced sweeping AI-driven workforce reductions in April 2025. If the majority of companies follow, the math is staggering.</p>
    </div>

    <!-- Quote card -->
    <div class="quote-card reveal reveal-delay-1">
      <div class="quote-text">"Within the next year, I believe the majority of companies will reach the same conclusion."</div>
      <div class="quote-attr">— Jack Dorsey, CEO of Block Inc., April 2025 · Following announcement of significant AI-driven headcount reduction</div>
    </div>

    <!-- Slider -->
    <div class="slider-section reveal reveal-delay-2">
      <div class="slider-label">Industry-wide AI headcount reduction scenario</div>
      <div class="slider-display"><span id="jobs-lost-display">2,600,000</span></div>
      <div class="slider-sub">jobs lost at <span id="pct-display">40</span>% cuts across 6.5M total tech workers</div>
      <input type="range" id="cut-slider" min="0" max="60" value="40" step="1">
      <div class="slider-range">
        <span>0% (No impact)</span>
        <span>30%</span>
        <span>60% (Maximum)</span>
      </div>
      <!-- Job dot grid -->
      <div class="job-grid" id="job-grid" style="margin-top:32px;"></div>
      <div style="margin-top:12px; font-size:12px; color:var(--text2);">
        <span style="display:inline-block; width:10px; height:10px; border-radius:50%; background:var(--accent); margin-right:6px;"></span>Employed
        <span style="display:inline-block; width:10px; height:10px; border-radius:50%; background:var(--red); margin-right:6px; margin-left:16px;"></span>Displaced
      </div>
    </div>

    <!-- Company impacts + Historical comparison -->
    <div class="grid-2 reveal reveal-delay-3">
      <div class="card">
        <div class="chart-title">Major Tech Company Impact at <span id="pct-company">40</span>%</div>
        <div id="company-chart">
          <div class="company-row">
            <div class="company-name">Amazon Tech</div>
            <div class="company-track"><div class="company-fill" data-base="300000" id="cf-amazon"><span id="cv-amazon">120K</span></div></div>
          </div>
          <div class="company-row">
            <div class="company-name">Microsoft</div>
            <div class="company-track"><div class="company-fill" data-base="228000" id="cf-msft"><span id="cv-msft">91.2K</span></div></div>
          </div>
          <div class="company-row">
            <div class="company-name">Google</div>
            <div class="company-track"><div class="company-fill" data-base="182000" id="cf-google"><span id="cv-google">72.8K</span></div></div>
          </div>
          <div class="company-row">
            <div class="company-name">Meta</div>
            <div class="company-track"><div class="company-fill" data-base="87000" id="cf-meta"><span id="cv-meta">34.8K</span></div></div>
          </div>
          <div class="company-row">
            <div class="company-name">Salesforce</div>
            <div class="company-track"><div class="company-fill" data-base="73000" id="cf-salesforce"><span id="cv-salesforce">29.2K</span></div></div>
          </div>
        </div>
        <div style="margin-top:20px; font-size:13px; color:var(--text2);">FAANG+ combined: <strong style="color:var(--text)" id="faang-total">~450K cuts</strong> at 40%</div>
      </div>

      <div class="card">
        <div class="chart-title">Historical Context: Scale of Displacement</div>
        <div class="hist-bars" id="hist-chart">
          <div class="hist-bar-wrap">
            <div class="hist-bar-val">260K</div>
            <div class="hist-bar" data-maxheight="160" data-height-pct="10" style="background: var(--accent); opacity:0.6;"></div>
            <div class="hist-bar-label">2022–23<br>Layoffs</div>
          </div>
          <div class="hist-bar-wrap">
            <div class="hist-bar-val">180K</div>
            <div class="hist-bar" data-maxheight="160" data-height-pct="7" style="background: var(--orange); opacity:0.7;"></div>
            <div class="hist-bar-label">2025<br>Layoffs</div>
          </div>
          <div class="hist-bar-wrap">
            <div class="hist-bar-val" id="hist-scenario-val">2.6M</div>
            <div class="hist-bar" data-maxheight="160" data-height-pct="100" id="hist-scenario-bar" style="background: var(--red);"></div>
            <div class="hist-bar-label">This<br>Scenario</div>
          </div>
        </div>
        <div style="margin-top:16px; font-size:13px; color:var(--red); font-weight:600;">This would be the largest white-collar displacement in American history — <span id="hist-mult">10×</span> larger than 2022–23 layoffs.</div>
      </div>
    </div>

  </div>
</section>


<!-- ═══════════════════════════════════════════════
     SECTION 3: ECONOMIC AFTERSHOCK
═══════════════════════════════════════════════ -->
<section id="s3" data-section="2">
  <div class="container">

    <div class="reveal">
      <div class="section-label">Section 03 — The Economic Aftershock</div>
      <h2 class="section-title">The $340 Billion<br>Ripple Effect</h2>
      <p class="section-desc">When 2.6 million high-earning workers stop earning, the economic shock doesn't stay in tech. It cascades through housing, tax revenue, local businesses, and the national unemployment system.</p>
    </div>

    <!-- Hero stat -->
    <div class="big-stat-hero reveal reveal-delay-1" style="margin-bottom:32px;">
      <div class="big-stat-num" data-countup="340" data-prefix="$" data-suffix="B">$340B</div>
      <div class="big-stat-desc">Estimated total economic impact from 2.6M displaced tech workers</div>
    </div>

    <!-- Donut + breakdown -->
    <div class="grid-2 reveal reveal-delay-2" style="margin-bottom:32px;">
      <div class="card" style="display:flex; flex-direction:column; align-items:center;">
        <div class="chart-title">Economic Impact Breakdown</div>
        <svg id="donut-svg" viewBox="0 0 240 240" width="240" height="240" style="display:block;margin:0 auto;overflow:visible;">
  <defs>
    <style>
      .donut-bg { fill: none; stroke: var(--surface2); stroke-width: 32; }
      .donut-arc { fill: none; stroke-width: 32; stroke-linecap: butt; }
      .donut-center-fill { fill: var(--surface); }
      .donut-center-text { font-family: Inter, -apple-system, sans-serif; text-anchor: middle; }
    </style>
  </defs>
  <!-- Background ring -->
  <circle class="donut-bg" cx="120" cy="120" r="90"/>
  <!-- Segments (rotate group -90deg so they start from top) -->
  <g transform="rotate(-90 120 120)">
    <!-- Consumer Spending $237B - blue -->
    <circle class="donut-arc" id="arc-consumer" cx="120" cy="120" r="90"
      stroke="#0071e3"
      stroke-dasharray="352.56 565.49"
      stroke-dashoffset="0"/>
    <!-- Tax Revenue $99B - orange -->
    <circle class="donut-arc" id="arc-tax" cx="120" cy="120" r="90"
      stroke="#ff9500"
      stroke-dasharray="147.28 565.49"
      stroke-dashoffset="-352.56"/>
    <!-- UI Payouts $34B - purple -->
    <circle class="donut-arc" id="arc-ui" cx="120" cy="120" r="90"
      stroke="#5856d6"
      stroke-dasharray="50.61 565.49"
      stroke-dashoffset="-499.84"/>
    <!-- Housing $10B - red -->
    <circle class="donut-arc" id="arc-housing" cx="120" cy="120" r="90"
      stroke="#ff3b30"
      stroke-dasharray="14.88 565.49"
      stroke-dashoffset="-550.45"/>
  </g>
  <!-- Center hole -->
  <circle class="donut-center-fill" cx="120" cy="120" r="70"/>
  <!-- Center text -->
  <text x="120" y="113" class="donut-center-text" font-size="20" font-weight="900" fill="var(--text)">$340B</text>
  <text x="120" y="133" class="donut-center-text" font-size="12" font-weight="500" fill="var(--text2)">total impact</text>
</svg>
        <div class="donut-legend">
          <div class="legend-item"><div class="legend-dot" style="background:#0071e3;"></div>Consumer Spending $237B</div>
          <div class="legend-item"><div class="legend-dot" style="background:#ff9500;"></div>Tax Revenue Loss $99B</div>
          <div class="legend-item"><div class="legend-dot" style="background:#ff3b30;"></div>Housing Impact $180B</div>
          <div class="legend-item"><div class="legend-dot" style="background:#5856d6;"></div>UI Payouts $34B</div>
      </div>

      <div class="card">
        <div class="chart-title">Impact Components</div>
        <div style="display:flex; flex-direction:column; gap:20px;">
          <div>
            <div style="display:flex; justify-content:space-between; align-items:baseline; margin-bottom:8px;">
              <div style="font-size:14px; font-weight:600; color:var(--text);">Lost Consumer Spending</div>
              <div style="font-size:22px; font-weight:900; color:#0071e3;">$237B</div>
            </div>
            <div style="font-size:13px; color:var(--text2);">2.6M workers × $130K avg spend × 70% consumption rate. Restaurants, retail, services in tech hubs take immediate hits.</div>
          </div>
          <div style="height:1px; background:var(--border);"></div>
          <div>
            <div style="display:flex; justify-content:space-between; align-items:baseline; margin-bottom:8px;">
              <div style="font-size:14px; font-weight:600; color:var(--text);">Lost Tax Revenue</div>
              <div style="font-size:22px; font-weight:900; color:var(--orange);">$98.8B</div>
            </div>
            <div style="font-size:13px; color:var(--text2);">2.6M × $38K avg fed+state tax. Federal shortfall alone: ~$50B annually. State budgets in CA, WA, NY severely impacted.</div>
          </div>
          <div style="height:1px; background:var(--border);"></div>
          <div>
            <div style="display:flex; justify-content:space-between; align-items:baseline; margin-bottom:8px;">
              <div style="font-size:14px; font-weight:600; color:var(--text);">UI System Strain</div>
              <div style="font-size:22px; font-weight:900; color:#5856d6;">$33.8B</div>
            </div>
            <div style="font-size:13px; color:var(--text2);">$500/wk × 26 weeks for 2.6M claimants. US system designed for ~5M total. This arrives in 6–12 months.</div>
          </div>
        </div>
      </div>
    </div>

    <!-- City housing heat -->
    <div class="card reveal reveal-delay-3" style="margin-bottom:32px;">
      <div class="chart-title">Housing Price Impact — Top Tech Metros</div>
      <div class="city-grid">
        <div class="city-card" style="background: rgba(255,59,48,0.12); border-color: rgba(255,59,48,0.25);">
          <div class="city-name">San Francisco</div>
          <div class="city-drop" style="color:var(--red);">−15%</div>
          <div class="city-label">Median home: $1.2M<br>→ <strong>$1.02M</strong></div>
        </div>
        <div class="city-card" style="background: rgba(255,59,48,0.08); border-color: rgba(255,59,48,0.2);">
          <div class="city-name">Seattle</div>
          <div class="city-drop" style="color:var(--red);">−13%</div>
          <div class="city-label">Median: $780K<br>→ <strong>$679K</strong></div>
        </div>
        <div class="city-card" style="background: rgba(255,149,0,0.10); border-color: rgba(255,149,0,0.25);">
          <div class="city-name">Austin</div>
          <div class="city-drop" style="color:var(--orange);">−11%</div>
          <div class="city-label">Median: $550K<br>→ <strong>$490K</strong></div>
        </div>
        <div class="city-card" style="background: rgba(255,149,0,0.08); border-color: rgba(255,149,0,0.2);">
          <div class="city-name">Boston</div>
          <div class="city-drop" style="color:var(--orange);">−10%</div>
          <div class="city-label">Median: $720K<br>→ <strong>$648K</strong></div>
        </div>
        <div class="city-card" style="background: rgba(255,204,0,0.10); border-color: rgba(255,204,0,0.3);">
          <div class="city-name">New York</div>
          <div class="city-drop" style="color:#c49000;">−7%</div>
          <div class="city-label">Broader market<br>partly insulated</div>
        </div>
        <div class="city-card" style="background: var(--surface2); border-color: var(--border);">
          <div class="city-name">National Avg</div>
          <div class="city-drop" style="color:var(--text2);">−3%</div>
          <div class="city-label">Housing/mortgage<br>market: −$180B</div>
        </div>
      </div>
    </div>

    <!-- Unemployment rate card -->
    <div class="card reveal reveal-delay-3" style="margin-bottom:32px;">
      <div class="chart-title">Unemployment Rate — Before &amp; After</div>
      <div style="display:grid; grid-template-columns: 1fr 1fr 1fr; gap:24px; margin:24px 0 28px;">
        <div style="text-align:center; padding:24px 16px; background:var(--surface2); border-radius:var(--radius-sm); border:1px solid var(--border);">
          <div style="font-size:13px; font-weight:600; text-transform:uppercase; letter-spacing:0.08em; color:var(--text2); margin-bottom:12px;">Today</div>
          <div style="font-size:52px; font-weight:900; letter-spacing:-0.03em; color:var(--green); line-height:1;">4.1%</div>
          <div style="font-size:13px; color:var(--text2); margin-top:8px;">6.8M unemployed<br>of 168M labor force</div>
        </div>
        <div style="text-align:center; padding:24px 16px; background:rgba(255,59,48,0.06); border-radius:var(--radius-sm); border:1px solid rgba(255,59,48,0.2);">
          <div style="font-size:13px; font-weight:600; text-transform:uppercase; letter-spacing:0.08em; color:var(--text2); margin-bottom:12px;">After 40% Cuts</div>
          <div style="font-size:52px; font-weight:900; letter-spacing:-0.03em; color:var(--red); line-height:1;">5.6%</div>
          <div style="font-size:13px; color:var(--text2); margin-top:8px;">9.4M unemployed<br>+2.6M in 12–24 months</div>
        </div>
        <div style="text-align:center; padding:24px 16px; background:var(--surface2); border-radius:var(--radius-sm); border:1px solid var(--border);">
          <div style="font-size:13px; font-weight:600; text-transform:uppercase; letter-spacing:0.08em; color:var(--text2); margin-bottom:12px;">Rate Increase</div>
          <div style="font-size:52px; font-weight:900; letter-spacing:-0.03em; color:var(--orange); line-height:1;">+37%</div>
          <div style="font-size:13px; color:var(--text2); margin-top:8px;">+1.5pp jump<br>fastest spike since 2008</div>
        </div>
      </div>
      <!-- Unemployment comparison bars -->
      <div style="margin-top:8px;">
        <div style="font-size:13px; font-weight:700; color:var(--text2); text-transform:uppercase; letter-spacing:0.06em; margin-bottom:16px;">Historical Peak Unemployment Comparisons</div>
        <div style="display:flex; flex-direction:column; gap:10px;">
          <div style="display:flex; align-items:center; gap:14px;">
            <div style="font-size:13px; font-weight:600; color:var(--text); min-width:170px;">Today (2025)</div>
            <div style="flex:1; height:28px; background:var(--surface2); border-radius:6px; overflow:hidden;">
              <div style="height:100%; width:27.9%; background:var(--green); border-radius:6px; display:flex; align-items:center; padding-left:10px;">
                <span style="font-size:12px; font-weight:700; color:white;">4.1%</span>
              </div>
            </div>
          </div>
          <div style="display:flex; align-items:center; gap:14px;">
            <div style="font-size:13px; font-weight:600; color:var(--text); min-width:170px;">This Scenario</div>
            <div style="flex:1; height:28px; background:var(--surface2); border-radius:6px; overflow:hidden;">
              <div style="height:100%; width:38.1%; background:var(--red); border-radius:6px; display:flex; align-items:center; padding-left:10px;">
                <span style="font-size:12px; font-weight:700; color:white;">5.6%</span>
              </div>
            </div>
          </div>
          <div style="display:flex; align-items:center; gap:14px;">
            <div style="font-size:13px; font-weight:600; color:var(--text); min-width:170px;">Dot-com bust peak</div>
            <div style="flex:1; height:28px; background:var(--surface2); border-radius:6px; overflow:hidden;">
              <div style="height:100%; width:42.9%; background:var(--orange); border-radius:6px; display:flex; align-items:center; padding-left:10px;">
                <span style="font-size:12px; font-weight:700; color:white;">6.3%</span>
              </div>
            </div>
          </div>
          <div style="display:flex; align-items:center; gap:14px;">
            <div style="font-size:13px; font-weight:600; color:var(--text); min-width:170px;">2008 recession peak</div>
            <div style="flex:1; height:28px; background:var(--surface2); border-radius:6px; overflow:hidden;">
              <div style="height:100%; width:68.1%; background:#5856d6; border-radius:6px; display:flex; align-items:center; padding-left:10px;">
                <span style="font-size:12px; font-weight:700; color:white;">10.0%</span>
              </div>
            </div>
          </div>
          <div style="display:flex; align-items:center; gap:14px;">
            <div style="font-size:13px; font-weight:600; color:var(--text); min-width:170px;">COVID-19 peak</div>
            <div style="flex:1; height:28px; background:var(--surface2); border-radius:6px; overflow:hidden;">
              <div style="height:100%; width:100%; background:#af52de; border-radius:6px; display:flex; align-items:center; padding-left:10px;">
                <span style="font-size:12px; font-weight:700; color:white;">14.7%</span>
              </div>
            </div>
          </div>
        </div>
      </div>
      <div style="margin-top:20px; padding:14px 18px; background:rgba(255,149,0,0.08); border-radius:10px; border-left:3px solid var(--orange); font-size:13px; color:var(--text2); line-height:1.6;">
        <strong style="color:var(--text);">Key distinction:</strong> The 2008 recession took 2 years to peak at 10%. This scenario could add 2.6M unemployed in as little as 12–18 months — concentrated in a single sector, in a handful of cities — creating a localized shock that's worse than the national numbers suggest. Tech metros like SF and Seattle could see local unemployment rates of 8–12%.
      </div>
    </div>

    <!-- Multiplier timeline -->
    <div class="card reveal reveal-delay-4">
      <div class="chart-title">Multiplier Effect — How It Cascades</div>
      <div class="timeline" style="margin-top:24px;">
        <div class="timeline-item">
          <div class="timeline-dot" style="background:var(--orange);"></div>
          <div class="timeline-time">Month 1–3</div>
          <div class="timeline-title">First Wave: Direct Income Loss</div>
          <div class="timeline-desc">2.6M workers stop receiving paychecks. Immediate 40% reduction in discretionary spending for affected households. Luxury goods & subscription services see first cancellations. Estimated: −$45B discretionary spending.</div>
        </div>
        <div class="timeline-item">
          <div class="timeline-dot" style="background:var(--red);"></div>
          <div class="timeline-time">Month 3–12</div>
          <div class="timeline-title">Second Wave: Local Economy Shock</div>
          <div class="timeline-desc">Restaurants, coffee shops, services in tech hubs see −15% revenue. Landlords in SF, Seattle, Austin face rising vacancies. Housing price correction begins. UI system claims spike to 2.6M new registrations — system stress begins. Estimated: −$237B consumer spending annualized.</div>
        </div>
        <div class="timeline-item">
          <div class="timeline-dot" style="background:#5856d6;"></div>
          <div class="timeline-time">Month 12–24</div>
          <div class="timeline-title">Third Wave: Fiscal & Systemic Impact</div>
          <div class="timeline-desc">State budgets in CA, WA, TX face $20–40B shortfalls. Federal income tax gap materializes: −$50B/yr. City services in tech hubs — schools, transit, public health — begin budget cuts. Housing correction deepens. Total addressable damage: −$340B across the full economic system.</div>
        </div>
      </div>
    </div>

  </div>
</section>


<!-- ═══════════════════════════════════════════════
     SECTION 4: WHERE DO THEY GO?
═══════════════════════════════════════════════ -->
<section id="s4" data-section="3">
  <div class="container">

    <div class="reveal">
      <div class="section-label">Section 04 — The Human Dimension</div>
      <h2 class="section-title">2.6 Million People.<br>What Happens Next?</h2>
      <p class="section-desc">History gives us clues. But the scale, speed, and sector-specificity of AI displacement is unlike anything the US workforce has seen before.</p>
    </div>

    <!-- Destination flow -->
    <div class="card reveal reveal-delay-1" style="margin-bottom:32px;">
      <div class="chart-title">Where Displaced Tech Workers Historically Land</div>
      <div class="destination-bars" style="margin-top:20px;">
        <div class="dest-row">
          <div class="dest-label">Stay in Tech (diff. companies)</div>
          <div class="dest-track"><div class="dest-fill" data-width="35" style="background:var(--accent);"><span>910K</span></div></div>
          <div class="dest-pct">35%</div>
        </div>
        <div class="dest-row">
          <div class="dest-label">Adjacent (finance, healthIT, gov)</div>
          <div class="dest-track"><div class="dest-fill" data-width="20" style="background:#5ac8fa;"><span>520K</span></div></div>
          <div class="dest-pct">20%</div>
        </div>
        <div class="dest-row">
          <div class="dest-label">Entrepreneurship / Freelance</div>
          <div class="dest-track"><div class="dest-fill" data-width="15" style="background:#34c759;"><span>390K</span></div></div>
          <div class="dest-pct">15%</div>
        </div>
        <div class="dest-row">
          <div class="dest-label">Teaching / Education</div>
          <div class="dest-track"><div class="dest-fill" data-width="10" style="background:#ff9500;"><span>260K</span></div></div>
          <div class="dest-pct">10%</div>
        </div>
        <div class="dest-row">
          <div class="dest-label">Career Change (non-tech)</div>
          <div class="dest-track"><div class="dest-fill" data-width="10" style="background:#5856d6;"><span>260K</span></div></div>
          <div class="dest-pct">10%</div>
        </div>
        <div class="dest-row">
          <div class="dest-label">Extended Unemployment (>2yr)</div>
          <div class="dest-track"><div class="dest-fill" data-width="10" style="background:var(--red);"><span>260K</span></div></div>
          <div class="dest-pct">10%</div>
        </div>
      </div>
    </div>

    <!-- New roles vs displaced -->
    <div class="grid-2 reveal reveal-delay-2" style="margin-bottom:32px;">
      <div class="card">
        <div class="chart-title">New AI Roles vs. Displaced Workers</div>
        <div style="margin-top:16px; display:flex; align-items:flex-end; gap:24px; height:220px;">
          <div style="flex:1; display:flex; flex-direction:column; align-items:center; height:100%;">
            <div style="font-size:22px; font-weight:900; color:var(--accent); margin-bottom:8px;">350K</div>
            <div style="flex:1; width:100%; display:flex; align-items:flex-end;">
              <div style="width:100%; background:var(--accent); border-radius:8px 8px 0 0; height:0%; transition: height 1.4s cubic-bezier(0.4,0,0.2,1);" class="animated-height" data-height="13.5"></div>
            </div>
            <div style="font-size:12px; color:var(--text2); margin-top:8px; text-align:center;">New AI Roles<br>by 2027</div>
          </div>
          <div style="flex:1; display:flex; flex-direction:column; align-items:center; height:100%;">
            <div style="font-size:22px; font-weight:900; color:var(--red); margin-bottom:8px;">2.6M</div>
            <div style="flex:1; width:100%; display:flex; align-items:flex-end;">
              <div style="width:100%; background:var(--red); border-radius:8px 8px 0 0; height:0%; transition: height 1.4s cubic-bezier(0.4,0,0.2,1);" class="animated-height" data-height="100"></div>
            </div>
            <div style="font-size:12px; color:var(--text2); margin-top:8px; text-align:center;">Workers<br>Displaced</div>
          </div>
        </div>
        <div style="margin-top:16px; padding:12px 16px; background:rgba(255,59,48,0.08); border-radius:8px; border-left:3px solid var(--red);">
          <div style="font-size:14px; font-weight:700; color:var(--red);">7.4% replacement rate</div>
          <div style="font-size:12px; color:var(--text2); margin-top:4px;">For every 14 jobs lost, only 1 new AI role is created. The math is brutal.</div>
        </div>
        <div style="margin-top:16px; font-size:13px; color:var(--text2);">
          Emerging roles: AI trainers (200K), Human-AI workflow designers (100K), AI safety & alignment (50K)
        </div>
      </div>

      <div class="card">
        <div class="chart-title">The Retraining Gap</div>
        <div class="retraining-gap" style="padding:40px 24px; margin-top:16px;">
          <div class="gap-number" data-countup="77" data-prefix="$" data-suffix="">$77</div>
          <div class="gap-label">per displaced worker<br>from CHIPS Act retraining fund</div>
        </div>
        <div style="margin-top:16px; font-size:13px; color:var(--text2); line-height:1.7;">
          CHIPS Act allocated $200M for tech retraining. Divided by 2.6M displaced workers = <strong style="color:var(--red);">$77 per person</strong>.<br><br>
          Average retraining program costs $5K–$40K and takes 6–18 months. Only ~55% lead to comparable salary.
        </div>
      </div>
    </div>

    <!-- Historical precedents -->
    <div class="card reveal reveal-delay-3">
      <div class="chart-title">Historical Precedents</div>
      <div class="prec-items">
        <div class="prec-item">
          <div>
            <div class="prec-year">2001</div>
            <div class="prec-era">Dot-com Bust</div>
          </div>
          <div>
            <div class="prec-title">500,000 Tech Jobs Lost</div>
            <div class="prec-desc">The dot-com crash wiped out ~500K tech jobs. Recovery took 5+ years. ~60% were reabsorbed into finance, consulting, and adjacent tech roles. The internet didn't disappear — it just restructured.</div>
            <div class="prec-outcome" style="background:rgba(52,199,89,0.1); color:var(--green);">60% reabsorption in 5 years</div>
          </div>
        </div>
        <div class="prec-item">
          <div>
            <div class="prec-year">1980s</div>
            <div class="prec-era">Manufacturing</div>
          </div>
          <div>
            <div class="prec-title">5 Million Jobs Lost (1980–2000)</div>
            <div class="prec-desc">Manufacturing automation and offshoring displaced 5M workers over two decades. Only ~40% found comparable roles. The communities that depended on these industries — the Rust Belt — never fully recovered. This is the closest historical analogue to what AI may do to tech.</div>
            <div class="prec-outcome" style="background:rgba(255,149,0,0.1); color:var(--orange);">40% reabsorption — communities hollowed out</div>
          </div>
        </div>
        <div class="prec-item">
          <div>
            <div class="prec-year">2025+</div>
            <div class="prec-era">This Scenario</div>
          </div>
          <div>
            <div class="prec-title">2.6 Million in 1–3 Years</div>
            <div class="prec-desc">Unlike dot-com (slow) or manufacturing (decades-long), AI displacement could happen in a compressed 12–36 month window. The workforce cannot retrain at that speed. The safety net isn't built for it. And unlike manufacturing, these are high-earning, highly-educated workers in concentrated metros — the fiscal and economic multiplier effects are outsized.</div>
            <div class="prec-outcome" style="background:rgba(255,59,48,0.1); color:var(--red);">No historical precedent at this speed or scale</div>
          </div>
        </div>
      </div>
    </div>

  </div>
</section>


<!-- ═══════════════════════════════════════════════
     FOOTER
═══════════════════════════════════════════════ -->
<footer>
  <div class="container">
    <p class="footer-quote">"The pace of AI adoption is accelerating. Whether this displacement scenario unfolds gradually over a decade or rapidly over 2–3 years will determine whether the workforce can adapt. History suggests it can — but not without friction, cost, and significant human consequence."</p>
    <div class="sources-title">Sources</div>
    <div class="sources-list">
      <div class="source-item">U.S. Bureau of Labor Statistics, 2024</div>
      <div class="source-item">CompTIA State of the Tech Workforce, 2024</div>
      <div class="source-item">Layoffs.fyi</div>
      <div class="source-item">Jack Dorsey / Block Inc., April 2025</div>
      <div class="source-item">Federal Reserve Economic Data (FRED)</div>
      <div class="source-item">National Center for Education Statistics</div>
    </div>
    <div style="margin-top:40px; font-size:12px; color:var(--text2); opacity:0.5;">
      This is a data visualization exploring a potential AI displacement scenario. All projections are estimates based on published data and stated corporate plans.
    </div>
  </div>
</footer>


<script>
/* ══════════════════════════════════════════════════
   THEME TOGGLE
══════════════════════════════════════════════════ */
const html = document.documentElement;
const toggleBtn = document.getElementById('theme-toggle');

function getTheme() {
  const stored = localStorage.getItem('theme');
  if (stored) return stored;
  return window.matchMedia('(prefers-color-scheme: dark)').matches ? 'dark' : 'light';
}

function setTheme(theme) {
  // Enable transitions only during manual toggle (not on initial load)
  html.classList.add('theme-transitioning');
  html.setAttribute('data-theme', theme);
  toggleBtn.textContent = theme === 'dark' ? '☀️' : '🌙';
  localStorage.setItem('theme', theme);
  setTimeout(() => {
    html.classList.remove('theme-transitioning');
    drawDonut();
  }, 400);
}

// Apply theme immediately on load without transition class
(function() {
  const stored = localStorage.getItem('theme');
  const t = stored || (window.matchMedia('(prefers-color-scheme: dark)').matches ? 'dark' : 'light');
  html.setAttribute('data-theme', t);
  toggleBtn.textContent = t === 'dark' ? '☀️' : '🌙';
})();

toggleBtn.addEventListener('click', () => {
  const current = html.getAttribute('data-theme');
  setTheme(current === 'dark' ? 'light' : 'dark');
});

/* ══════════════════════════════════════════════════
   GSAP SETUP
══════════════════════════════════════════════════ */
gsap.registerPlugin(ScrollTrigger);

/* ══════════════════════════════════════════════════
   PROGRESS BAR — GSAP scrub (frame-perfect, off main thread)
══════════════════════════════════════════════════ */
gsap.to('#progress', {
  scaleX: 1,
  ease: 'none',
  scrollTrigger: {
    start: 'top top',
    end: 'bottom bottom',
    scrub: 0.3,
  }
});

/* ══════════════════════════════════════════════════
   SECTION NAV DOTS
══════════════════════════════════════════════════ */
const sections = document.querySelectorAll('section[data-section]');
const dots = document.querySelectorAll('.nav-dot');

dots.forEach(dot => {
  dot.addEventListener('click', () => {
    const idx = parseInt(dot.dataset.section);
    sections[idx].scrollIntoView({ behavior: 'smooth' });
  });
});

sections.forEach(sec => {
  ScrollTrigger.create({
    trigger: sec,
    start: 'top 60%',
    end: 'bottom 40%',
    onToggle: self => {
      if (self.isActive) {
        const idx = sec.dataset.section;
        dots.forEach(d => d.classList.remove('active'));
        document.querySelector(`.nav-dot[data-section="${idx}"]`)?.classList.add('active');
      }
    }
  });
});

/* ══════════════════════════════════════════════════
   REVEAL ANIMATIONS — GSAP (compositor-native, GPU-smooth)
══════════════════════════════════════════════════ */
// Set initial state via GSAP so it's managed on compositor
gsap.set('.reveal', { opacity: 0, y: 20 });

gsap.utils.toArray('.reveal').forEach(el => {
  gsap.to(el, {
    opacity: 1, y: 0,
    duration: 0.65,
    ease: 'power2.out',
    scrollTrigger: {
      trigger: el,
      start: 'top 90%',
      once: true,
    }
  });
});

/* ══════════════════════════════════════════════════
   COUNT UP — GSAP (no custom rAF needed)
══════════════════════════════════════════════════ */
gsap.utils.toArray('[data-countup]').forEach(el => {
  const target = parseFloat(el.dataset.countup);
  const prefix = el.dataset.prefix || '';
  const suffix = el.dataset.suffix || '';
  const divisor = parseFloat(el.dataset.divisor) || 1;
  const decimals = parseInt(el.dataset.decimals) || 0;
  const obj = { val: 0 };
  gsap.to(obj, {
    val: target / divisor,
    duration: 2,
    ease: 'power2.out',
    onUpdate: () => { el.textContent = prefix + obj.val.toFixed(decimals) + suffix; },
    scrollTrigger: { trigger: el, start: 'top 92%', once: true }
  });
});

/* ══════════════════════════════════════════════════
   SECTION 1 CHART ANIMATIONS
══════════════════════════════════════════════════ */
// Metro bars
gsap.set('.metro-fill', { scaleX: 0, transformOrigin: 'left center' });
gsap.utils.toArray('.metro-fill').forEach(el => {
  gsap.to(el, {
    scaleX: parseFloat(el.dataset.width) / 100,
    duration: 1.1,
    ease: 'power2.out',
    scrollTrigger: { trigger: '#s1', start: 'top 65%', once: true }
  });
});

// Age bars
gsap.set('.age-bar', { scaleY: 0, transformOrigin: 'bottom center' });
gsap.utils.toArray('.age-bar').forEach((el, i) => {
  gsap.to(el, {
    scaleY: 1,
    duration: 0.8,
    delay: i * 0.08,
    ease: 'power2.out',
    scrollTrigger: { trigger: '#s1', start: 'top 65%', once: true }
  });
});

/* ══════════════════════════════════════════════════
   SECTION 2: SLIDER
══════════════════════════════════════════════════ */
const slider = document.getElementById('cut-slider');
const jobsDisplay = document.getElementById('jobs-lost-display');
const pctDisplay = document.getElementById('pct-display');
const pctCompany = document.getElementById('pct-company');
const faangTotal = document.getElementById('faang-total');
const histScenarioVal = document.getElementById('hist-scenario-val');
const histMult = document.getElementById('hist-mult');

// Build job grid (100 dots)
const jobGrid = document.getElementById('job-grid');
const TOTAL_DOTS = 100;
const dots100 = [];
for (let i = 0; i < TOTAL_DOTS; i++) {
  const dot = document.createElement('div');
  dot.className = 'job-dot';
  jobGrid.appendChild(dot);
  dots100.push(dot);
}

const companybases = { amazon:300000, msft:228000, google:182000, meta:87000, salesforce:73000 };

function fmtJobs(n) {
  if (n >= 1000000) return (n/1000000).toFixed(1)+'M';
  if (n >= 1000) return (n/1000).toFixed(0)+'K';
  return n.toString();
}

function updateSliderFast(pct) {
  const jobsLost = Math.round(6500000 * pct / 100);
  jobsDisplay.textContent = jobsLost.toLocaleString();
  pctDisplay.textContent = pct;
  pctCompany.textContent = pct;
  Object.entries(companybases).forEach(([key, base]) => {
    const cuts = Math.round(base * pct / 100);
    const fill = document.getElementById('cf-' + key);
    const val = document.getElementById('cv-' + key);
    if (fill && val) {
      gsap.set(fill, { scaleX: Math.min(cuts / 180000, 1) });
      val.textContent = fmtJobs(cuts);
    }
  });
  faangTotal.textContent = '~' + fmtJobs(Math.round(870000 * pct / 100)) + ' cuts';
  histMult.textContent = (pct === 0 ? 0 : Math.round(jobsLost / 260000)) + '×';
  histScenarioVal.textContent = fmtJobs(jobsLost);
  const p = pct / 60;
  slider.style.background = `linear-gradient(90deg, #2997ff 0%, #ff3b30 ${p*100}%, var(--surface2) ${p*100}%)`;
}

let dotTimer = null;
function updateDots(pct) {
  const dotsRed = Math.round(TOTAL_DOTS * pct / 100);
  requestAnimationFrame(() => {
    dots100.forEach((dot, i) => {
      const should = i < dotsRed;
      if (dot.classList.contains('displaced') !== should) dot.classList.toggle('displaced', should);
    });
  });
}

function updateSlider(pct) {
  updateSliderFast(pct);
  clearTimeout(dotTimer);
  dotTimer = setTimeout(() => updateDots(pct), 60);
}

slider.addEventListener('input', () => updateSlider(parseInt(slider.value)), { passive: true });

// Hist bars + company fills animate when s2 enters view
gsap.set('.hist-bar', { height: 0 });
ScrollTrigger.create({
  trigger: '#s2',
  start: 'top 65%',
  once: true,
  onEnter: () => {
    updateSlider(40);
    document.querySelectorAll('.hist-bar').forEach(bar => {
      const maxH = parseFloat(bar.dataset.maxheight || 160);
      const pctH = parseFloat(bar.dataset.heightPct || 50);
      gsap.to(bar, { height: (maxH * pctH / 100) + 'px', duration: 1.1, ease: 'power2.out' });
    });
  }
});

/* ══════════════════════════════════════════════════
   SECTION 3: SVG DONUT ANIMATION
══════════════════════════════════════════════════ */
ScrollTrigger.create({
  trigger: '#donut-svg',
  start: 'top 80%',
  once: true,
  onEnter: () => {
    // Animate each arc appearing via strokeDashoffset
    const arcs = [
      { id: 'arc-consumer', len: 352.56 },
      { id: 'arc-tax',      len: 147.28 },
      { id: 'arc-ui',       len: 50.61  },
      { id: 'arc-housing',  len: 14.88  },
    ];
    arcs.forEach((a, i) => {
      const el = document.getElementById(a.id);
      if (!el) return;
      // We'll animate opacity + scale for a clean reveal
      gsap.from(el, {
        opacity: 0,
        scale: 0.85,
        transformOrigin: '120px 120px',
        duration: 0.6,
        delay: i * 0.12,
        ease: 'back.out(1.5)',
        scrollTrigger: false
      });
    });
  }
});

/* ══════════════════════════════════════════════════
   SECTION 4: DESTINATION BARS + ANIMATED HEIGHTS
══════════════════════════════════════════════════ */
gsap.set('.dest-fill', { scaleX: 0, transformOrigin: 'left center' });
ScrollTrigger.create({
  trigger: '#s4',
  start: 'top 65%',
  once: true,
  onEnter: () => {
    gsap.utils.toArray('.dest-fill').forEach((el, i) => {
      gsap.to(el, {
        scaleX: parseFloat(el.dataset.width) / 100,
        duration: 1.0,
        delay: i * 0.07,
        ease: 'power2.out'
      });
    });
    gsap.utils.toArray('.animated-height').forEach((el, i) => {
      gsap.to(el, {
        scaleY: parseFloat(el.dataset.height) / 100,
        duration: 1.1,
        delay: i * 0.1,
        ease: 'power2.out',
        transformOrigin: 'bottom center'
      });
    });
  }
});

/* ══════════════════════════════════════════════════
   LOADING SCREEN + INIT
══════════════════════════════════════════════════ */
const loader = document.getElementById('loader');
const loaderFill = document.getElementById('loader-fill');

function setLoaderProgress(pct) {
  if (loaderFill) loaderFill.style.width = pct + '%';
}

function dismissLoader() {
  loader.classList.add('fade-out');
  setTimeout(() => {
    loader.style.display = 'none';
    ScrollTrigger.refresh(); // recalculate all positions after loader hidden
  }, 520);
}

window.addEventListener('load', () => {
  setTimeout(() => {
    setLoaderProgress(40);
    // Force all sections to lay out
    document.querySelectorAll('section').forEach(s => void s.offsetHeight);
    setLoaderProgress(70);
    updateSlider(40);
    setLoaderProgress(90);
    ScrollTrigger.refresh();
    setLoaderProgress(100);
    setTimeout(dismissLoader, 180);
  }, 120);
});

/* ══════════════════════════════════════════════════
   SOURCES FAB + CONSOLIDATED MODAL
══════════════════════════════════════════════════ */
const allSources = [
  {
    group: 'Section 1 — The Industry Today',
    items: [
      { name: 'BLS Occupational Employment & Wage Statistics — Software Developers (SOC 15-1252)', url: 'https://www.bls.gov/oes/current/oes151252.htm' },
      { name: 'BLS — All Computer & IT Occupations (SOC 15-0000)', url: 'https://www.bls.gov/oes/current/oes_nat.htm#15-0000' },
      { name: 'CompTIA State of the Tech Workforce 2024', url: 'https://www.comptia.org/content/research/state-of-the-tech-workforce' },
      { name: 'CBRE Tech Talent Report 2024 — Metro Rankings', url: 'https://www.cbre.com/insights/reports/scoring-tech-talent' },
      { name: 'BLS Current Population Survey — Worker Age Distribution', url: 'https://www.bls.gov/cps/cpsaat11.htm' },
      { name: 'Levels.fyi 2024 Compensation Report', url: 'https://www.levels.fyi/2024/' },
      { name: 'NCES Digest of Education Statistics — CS Bachelor’s Degrees Conferred', url: 'https://nces.ed.gov/programs/digest/d23/tables/dt23_325.35.asp' },
      { name: 'Computing Research Association — Taulbee Survey (CS enrollment & degrees)', url: 'https://cra.org/resources/taulbee-survey/' },
    ]
  },
  {
    group: 'Section 2 — The Block Effect',
    items: [
      { name: 'Jack Dorsey on X — AI headcount reduction announcement, April 2025', url: 'https://x.com/jack/status/1909660839386624028' },
      { name: 'Reuters — Block cuts 40% of staff citing AI productivity', url: 'https://www.reuters.com/technology/jack-dorsey-says-block-cutting-more-employees-2025-04-08/' },
      { name: 'SEC 10-K Filings — Employee headcount (Google, Microsoft, Meta, Amazon, Salesforce)', url: 'https://www.sec.gov/cgi-bin/browse-edgar?action=getcompany&type=10-K' },
      { name: 'Layoffs.fyi — 2022–2025 Tech Layoff Tracker', url: 'https://layoffs.fyi' },
      { name: 'TechCrunch Layoff Tracker 2022–2023', url: 'https://techcrunch.com/2023/01/05/tech-layoffs-soar-in-2022/' },
    ]
  },
  {
    group: 'Section 3 — The Economic Aftershock',
    items: [
      { name: 'BEA Personal Consumption Expenditures — Consumer spending data', url: 'https://www.bea.gov/data/consumer-spending/main' },
      { name: 'IRS Statistics of Income — Tax burden by income level', url: 'https://www.irs.gov/statistics/soi-tax-stats-individual-statistical-tables-by-size-of-adjusted-gross-income' },
      { name: 'BLS Monthly Unemployment Rate (U-3) — Current & historical', url: 'https://www.bls.gov/charts/employment-situation/civilian-unemployment-rate.htm' },
      { name: 'FRED — UNRATE (Federal Reserve unemployment time series)', url: 'https://fred.stlouisfed.org/series/UNRATE' },
      { name: 'BLS — Dot-com & Great Recession historical unemployment', url: 'https://www.bls.gov/cps/prev_yrs.htm' },
      { name: 'Zillow Research — Metro Home Value Index', url: 'https://www.zillow.com/research/data/' },
      { name: 'NAR — Metropolitan Median Home Prices', url: 'https://www.nar.realtor/research-and-statistics/housing-statistics/metropolitan-median-area-prices-and-affordability' },
      { name: 'FRED — Unemployment Insurance Weekly Claims', url: 'https://fred.stlouisfed.org/series/ICSA' },
    ]
  },
  {
    group: 'Section 4 — Where Do They Go?',
    items: [
      { name: 'BLS Displaced Workers Survey — Re-employment outcomes', url: 'https://www.bls.gov/cps/displaced.htm' },
      { name: 'World Economic Forum — Future of Jobs Report 2025', url: 'https://www.weforum.org/reports/the-future-of-jobs-report-2025/' },
      { name: 'McKinsey Global Institute — The Future of Work After COVID-19', url: 'https://www.mckinsey.com/featured-insights/future-of-work/the-future-of-work-after-covid-19' },
      { name: 'CHIPS and Science Act — Workforce Development Provisions ($200M)', url: 'https://www.nist.gov/system/files/documents/2022/08/09/CHIPS-Science-Act-Summary.pdf' },
      { name: 'Georgetown CEW — Returns on Investment in Workforce Training', url: 'https://cew.georgetown.edu/cew-reports/roi/' },
      { name: 'BLS — Dot-com Recession Employment Recovery (2001–2003)', url: 'https://www.bls.gov/opub/mlr/2004/01/art1full.pdf' },
      { name: 'Economic Policy Institute — Manufacturing Job Loss & Rust Belt', url: 'https://www.epi.org/publication/manufacturing-job-loss/' },
    ]
  },
];

const modalOverlay = document.getElementById('source-modal-overlay');
const modalBody = document.getElementById('source-modal-body');
const modalClose = document.getElementById('source-modal-close');
const fab = document.getElementById('sources-fab');

function openSourcesModal() {
  modalBody.innerHTML = allSources.map(section =>
    `<div class="source-group">
      <div class="source-group-title">${section.group}</div>
      ${section.items.map(s =>
        `<div class="source-item">
          <div class="source-item-name">${s.name}</div>
          <div class="source-item-url"><a href="${s.url}" target="_blank" rel="noopener">${s.url}</a></div>
        </div>`
      ).join('')}
    </div>`
  ).join('');
  modalOverlay.classList.add('open');
  document.body.style.overflow = 'hidden';
}

function closeModal() {
  modalOverlay.classList.remove('open');
  document.body.style.overflow = '';
}

fab.addEventListener('click', openSourcesModal);
modalClose.addEventListener('click', closeModal);
modalOverlay.addEventListener('click', (e) => { if (e.target === modalOverlay) closeModal(); });
document.addEventListener('keydown', (e) => { if (e.key === 'Escape') closeModal(); });
</script>
</body>
</html>